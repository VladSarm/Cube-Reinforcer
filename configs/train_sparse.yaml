# Sparse REINFORCE (PyTorch): 7 cells (a..g), 6 actions (U/L/B), H fixed.
# Architecture: obs(31) -> 512 -> ELU -> 128 -> ELU -> 6
# Observation: sparse_state(7) + action_history_one_hot(4*6=24) -> input_dim=31

policy:
  input_dim: 31          # 7 sparse bits + 4*6 action history one-hot
  hidden_dim_1: 512
  hidden_dim_2: 128
  action_dim: 6
  history_len: 4

training:
  device: cuda
  num_envs: 4096         # max safe batch on RTX 3070 Ti 8GB (peak ~4.2 GB VRAM with T=200)
  episodes: 5000000
  scramble_steps: 30     # fixed â€” maximally random cube every episode
  start_level: 1         # curriculum: start with 1 corner, grows to 7 when SR > 80%
  max_episode_steps: 200
  gamma: 1.0
  lr: 3.0e-4
  save_every: 50000
  checkpoint_dir: checkpoints_sparse_torch
  tensorboard_logdir: runs/cube_reinforcer_sparse
  seed: null
  log_interval: 1000
  repeat_penalty: 1.0    # penalty for 3rd consecutive identical action or oscillation
